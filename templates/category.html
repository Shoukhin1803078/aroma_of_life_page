{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2 class="category-title" id="page-title">{{ category.name.en }}</h2>

    <!-- Quick Links -->
    <div class="category-quick-links" style="margin-bottom: 2rem;">
        {% for cat in data.categories %}
        <a href="/category/{{ cat.id }}" class="quick-btn" data-key="categories.{{ loop.index0 }}.name">{{ cat.name.en
            }}</a>
        {% endfor %}
    </div>

    <div class="product-grid">
        {% if category.subcategories %}
        {% for sub in category.subcategories %}
        <a href="/category/{{ sub.id }}" class="product-card subcategory-card">
            <div class="product-image">
                <div class="img-placeholder">{{ sub.name.en[0] }}</div>
            </div>
            <div class="product-info">
                <h3 class="item-name" data-id="{{ sub.id }}">{{ sub.name.en }}</h3>
            </div>
        </a>
        {% endfor %}
        {% elif category['items'] %}
        {% for item in category['items'] %}
        {% if category.type == 'service' %}
        <!-- Service Profile Card -->
        <!-- Service Profile Card -->
        <a href="/category/{{ category.id }}/product/{{ item.id }}" class="product-card profile-card"
            style="text-decoration: none; color: inherit; display: block;">
            <div class="product-image profile-image">
                <div class="img-placeholder">{{ item.name.en[0] }}</div>
            </div>
            <div class="product-info">
                <h3 class="item-name" data-id="{{ item.id }}">{{ item.name.en }}</h3>
                {% if item.brand %}
                <p class="item-brand" style="font-size: 0.85rem; color: #666; margin-bottom: 0.2rem;">{{ item.brand.en
                    }}</p>
                {% endif %}
                <div class="profile-details">
                    <p><strong data-key="settings.cart_labels.experience">Experience</strong>: <span class="exp-text">{{
                            item.experience.en }}</span></p>
                    <p><strong data-key="settings.cart_labels.rating">Rating</strong>: ⭐ {{ item.rating }}</p>
                    <p class="expertise">{{ item.expertise.en }}</p>
                </div>
                <p class="price">৳{{ item.price }} {% if item.unit %}/ {{ item.unit }}{% endif %}</p>
                <button class="add-to-cart-btn hire-btn" data-id="{{ item.id }}" data-name-en="{{ item.name.en }}"
                    data-name-bn="{{ item.name.bn }}" data-price="{{ item.price }}" {% if item.id=='consult_online'
                    %}data-direct-checkout="true" {% endif %} data-key="settings.cart_labels.hire">
                    {% if item.id == 'consult_online' %}
                    Book Consultation
                    {% else %}
                    Hire Now
                    {% endif %}
                </button>
            </div>
        </a>
        {% else %}
        <!-- Standard Product Card -->
        <a href="/category/{{ category.id }}/product/{{ item.id }}" class="product-card"
            style="text-decoration: none; color: inherit; display: block;">
            <div class="product-image">
                {% if item.image %}
                <img src="{{ url_for('static', path=item.image) }}" alt="{{ item.name.en }}" class="card-img">
                {% else %}
                <div class="img-placeholder">{{ item.name.en[0] }}</div>
                {% endif %}
                {% if item.original_price and item.original_price > item.price %}
                <span class="card-discount-badge">Sale</span>
                {% endif %}
            </div>
            <div class="product-info">
                <h3 class="item-name" data-id="{{ item.id }}">{{ item.name.en }}</h3>
                {% if item.brand %}
                <p class="item-brand" style="font-size: 0.85rem; color: #666; margin-bottom: 0.2rem;">{{ item.brand.en
                    }}</p>
                {% endif %}

                {% if item.rating %}
                <div class="card-rating">
                    <span class="stars">★</span> {{ item.rating }} <span class="review-count">({{ item.reviews_count
                        }})</span>
                </div>
                {% endif %}

                <div class="price-row">
                    <p class="price">৳{{ item.price }} {% if item.unit %}/ {{ item.unit }}{% endif %}</p>
                    {% if item.original_price %}
                    <p class="original-price-sm">৳{{ item.original_price }}</p>
                    {% endif %}
                </div>

                <button class="add-to-cart-btn" data-id="{{ item.id }}" data-name-en="{{ item.name.en }}"
                    data-name-bn="{{ item.name.bn }}" data-price="{{ item.price }}"
                    data-key="settings.cart_labels.add_to_cart">Add to Cart</button>
            </div>
        </a>
        {% endif %}
        {% endfor %}
        {% endif %}
    </div>
</div>

<script>
    // Pass category data to JS for dynamic language switching on this page specific elements if needed
    const currentCategory = {{ category | tojson }};
</script>
{% endblock %}